//************************************************************************************************************

// Code developed by Mojtaba Madadi Asl.
// Email: mojtabamadadi7@gmail.com

//************************************************************************************************************

#include <iostream>
#include <cmath>
#include <fstream>

using namespace std;

//************************************************************************************************************

int main(){

	ofstream outfile1("outputA - no use.txt");
	ofstream outfile2("outputB.txt");

	float T1, T2, p_min, p_max, q_min, q_max, p, q, p_star, q_star, a11, a12, a21, a22, b11, b12, b21, b22, E11, E12, E21, E22, dE1, dE2;

	a11 = 2.0;
	a12 = 0.0;
	a21 = 0.0;
	a22 = 1.0;
	b11 = 1.0;
	b12 = 0.0;
	b21 = 0.0;
	b22 = 2.0;

	p_star = 2.0 / 3.0;
	q_star = 1.0 / 3.0;

	p_min = 0.0;
	p_max = 1.0;
	p_min = 0.0;
	p_max = 1.0;

//************************************************************************************************************

	for (p = 0.0; p <= 1.05; p = p + 0.05){
		for (q = 0.0; q <= 1.05; q = q + 0.05){
		
			E11 = (p * q * a11) + (p * (1.0 - q) * a12);
			E12 = ((1.0 - p) * q * a21) + ((1.0 - p) * (1.0 - q) * a22);
			dE1 = abs(E11 - E12);

			E21 = (q * p * b11) + (q * (1.0 - p) * b21);
			E22 = ((1.0 - q) * p * b12) + ((1.0 - q) * (1.0 - p) * b22);
			dE2 = abs(E21 - E22);

			if (p == p_star)     T1 = 0.0;
			else if (p < p_star) T1 = - abs(dE1) / (log((p - p_star) / (p_min - p_star)));
			else                 T1 = - abs(dE1) / (log((p - p_star) / (p_max - p_star)));

			if (q == q_star)     T2 = 0.0;
			else if (q < q_star) T2 = - abs(dE2) / (log((q - q_star) / (q_min - q_star)));
			else                 T2 = - abs(dE2) / (log((q - q_star) / (q_max - q_star)));

			outfile1 << p << '\t' << q << '\t' << dE1 << '\t' << T1 << endl;
			outfile2 << p << '\t' << q << '\t' << dE2 << '\t' << T2 << endl;
		}
	}


//************************************************************************************************************

	outfile1.close();
	outfile2.close();

return 0;

}

//************************************************************************************************************
//************************************************************************************************************
